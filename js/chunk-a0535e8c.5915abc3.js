(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a0535e8c"],{"13d5":function(e,t,a){"use strict";var l=a("23e7"),o=a("d58f").left,n=a("a640"),c=a("2d00"),r=a("605d"),u=n("reduce"),d=!r&&c>79&&c<83;l({target:"Array",proto:!0,forced:!u||d},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},"57ec":function(e,t,a){"use strict";a.r(t);var l=a("7a23");const o={class:"teacher-wrapper"},n={class:"teacher-header"},c={class:"teacher-table"};function r(e,t,a,r,u,d){const i=Object(l["resolveComponent"])("TButton"),m=Object(l["resolveComponent"])("TeacherFilter"),b=Object(l["resolveComponent"])("TFilter"),s=Object(l["resolveComponent"])("TTable"),p=Object(l["resolveComponent"])("Create"),h=Object(l["resolveComponent"])("TModal"),v=Object(l["resolveComponent"])("Edit"),O=Object(l["resolveComponent"])("Delete");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",o,[Object(l["createElementVNode"])("div",n,[Object(l["createVNode"])(i,{title:"新增",type:"primary",class:"n-mb-md",icon:e.Add12Filled,onClick:e.openCreate},null,8,["icon","onClick"]),Object(l["createVNode"])(b,{onClear:e.clearFilter,onSubmit:e.submitFilter},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{ref:"refFilter",form:e.formValue,"onUpdate:form":t[0]||(t[0]=t=>e.formValue=t)},null,8,["form"])]),_:1},8,["onClear","onSubmit"])]),Object(l["createElementVNode"])("div",c,[Object(l["createVNode"])(s,{loading:e.loading,columns:e.columns,tableKey:e.tableKey,data:e.teacherData,filterFrom:e.filterFrom,"onUpdate:sorter":e.handleUpdateSorter},null,8,["loading","columns","tableKey","data","filterFrom","onUpdate:sorter"])]),Object(l["createVNode"])(h,{showModal:e.showModal.create,"onUpdate:showModal":t[1]||(t[1]=t=>e.showModal.create=t),title:"新增老師",onCancel:t[2]||(t[2]=t=>e.showModal.create=!1),onSubmit:e.addTeacher},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(p,{ref:"refCreate"},null,512)]),_:1},8,["showModal","onSubmit"]),Object(l["createVNode"])(h,{showModal:e.showModal.edit,"onUpdate:showModal":t[3]||(t[3]=t=>e.showModal.edit=t),title:"編輯老師",onCancel:e.cancelEdit,onSubmit:e.updateTeacher},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(v,{ref:"refEdit",data:e.currentModalData},null,8,["data"])]),_:1},8,["showModal","onCancel","onSubmit"]),Object(l["createVNode"])(h,{showModal:e.showModal.delete,"onUpdate:showModal":t[4]||(t[4]=t=>e.showModal.delete=t),title:"刪除老師",onCancel:e.cancelDelete,onSubmit:e.deleteTeacher},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{ref:"refDelete",data:e.currentModalData},null,8,["data"])]),_:1},8,["showModal","onCancel","onSubmit"])])}a("13d5"),a("14d9");var u=a("65e2"),d=a("6dc9"),i=a("3519"),m=a("0b62"),b=a("269c");const s={class:"n-pt-md"};var p={__name:"Filter",props:{form:{type:Object,default(){return{}}}},setup(e,{expose:t}){const a=e,o={school:Object(b["a"])()},n=Object(l["computed"])(()=>o.school.list.map(e=>({label:e.name,value:e.id}))),c=Object(l["ref"])(null),r=Object(l["computed"])({get:()=>a.form,set:e=>emit("update:form",e)}),u=["name","phone","email","manageSchool"],d=Object(l["reactive"])({}),i=()=>{u.forEach(e=>{var t;switch(e){case"name":case"phone":case"email":const a=new RegExp(""+(null!==(t=r.value[e])&&void 0!==t?t:""));d[e]=e=>a.test(e);break;case"manageSchool":if(r.value[e]){const t=r.value[e];d[e]=e=>{const a=e.$findIndex(e=>e===t);return a>-1}}else d[e]=e=>!0;break;default:d[e]=e=>!0;break}})};return t({setData:i,getData:()=>d}),(e,t)=>{const a=Object(l["resolveComponent"])("n-input"),o=Object(l["resolveComponent"])("n-form-item"),u=Object(l["resolveComponent"])("n-select"),d=Object(l["resolveComponent"])("n-form");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",s,[Object(l["createVNode"])(d,{ref_key:"formRef",ref:c,model:Object(l["unref"])(r)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(o,{label:"名稱",path:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:Object(l["unref"])(r).name,"onUpdate:value":t[0]||(t[0]=e=>Object(l["unref"])(r).name=e),placeholder:"输入名稱"},null,8,["value"])]),_:1}),Object(l["createVNode"])(o,{label:"電話",path:"phone"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:Object(l["unref"])(r).phone,"onUpdate:value":t[1]||(t[1]=e=>Object(l["unref"])(r).phone=e),placeholder:"输入電話"},null,8,["value"])]),_:1}),Object(l["createVNode"])(o,{label:"Email",path:"email"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:Object(l["unref"])(r).email,"onUpdate:value":t[2]||(t[2]=e=>Object(l["unref"])(r).email=e),placeholder:"輸入Email"},null,8,["value"])]),_:1}),Object(l["createVNode"])(o,{label:"學校",path:"manageSchool"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{value:Object(l["unref"])(r).manageSchool,"onUpdate:value":t[3]||(t[3]=e=>Object(l["unref"])(r).manageSchool=e),placeholder:"輸入學校",options:Object(l["unref"])(n)},null,8,["value","options"])]),_:1})]),_:1},8,["model"])])}}};const h=p;var v=h,O={__name:"Create",setup(e,{expose:t}){const a={school:Object(b["a"])()},o=Object(l["computed"])(()=>a.school.list.map(e=>({label:e.name,value:e.id}))),n=Object(l["ref"])(null),c=Object(l["ref"])({name:null,phone:null,email:null,manageSchool:[]});return t({setData(e){c.value=e},getData(){return c.value},upload(e){return Object(m["a"])({url:"/teacher",method:"post",data:e},{fakeData:null,getFakeData:!0})}}),(e,t)=>{const a=Object(l["resolveComponent"])("n-input"),r=Object(l["resolveComponent"])("n-form-item"),u=Object(l["resolveComponent"])("n-select"),d=Object(l["resolveComponent"])("n-form");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(d,{ref_key:"formRef",ref:n,model:c.value},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(r,{label:"名稱",path:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:c.value.name,"onUpdate:value":t[0]||(t[0]=e=>c.value.name=e),placeholder:"输入名稱"},null,8,["value"])]),_:1}),Object(l["createVNode"])(r,{label:"電話",path:"phone"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:c.value.phone,"onUpdate:value":t[1]||(t[1]=e=>c.value.phone=e),placeholder:"输入電話"},null,8,["value"])]),_:1}),Object(l["createVNode"])(r,{label:"Email",path:"email"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:c.value.email,"onUpdate:value":t[2]||(t[2]=e=>c.value.email=e),placeholder:"輸入Email"},null,8,["value"])]),_:1}),Object(l["createVNode"])(r,{label:"學校",path:"manageSchool"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{value:c.value.manageSchool,"onUpdate:value":t[3]||(t[3]=e=>c.value.manageSchool=e),placeholder:"輸入學校",options:Object(l["unref"])(o),multiple:""},null,8,["value","options"])]),_:1})]),_:1},8,["model"])])}}};const j=O;var f=j,g={__name:"Edit",props:{data:{type:Object,default(){return{id:null,name:null,phone:null,email:null,manageSchool:[]}}}},setup(e,{expose:t}){const a=e,o=Object(l["ref"])(null),n={school:Object(b["a"])()},c=Object(l["computed"])(()=>n.school.list.map(e=>({label:e.name,value:e.id}))),r=Object(l["ref"])({id:null,name:null,phone:null,email:null,manageSchool:[]});return Object(l["onMounted"])(()=>{a.data.$forEach((e,t)=>{r.value[t]=e})}),t({setData(e){r.value=e},getData(){return r.value},upload(e,t){return Object(m["a"])({url:"/teacher/"+t,method:"put",data:e},{fakeData:null,getFakeData:!0})}}),(e,t)=>{const a=Object(l["resolveComponent"])("n-input"),n=Object(l["resolveComponent"])("n-form-item"),u=Object(l["resolveComponent"])("n-select"),d=Object(l["resolveComponent"])("n-form");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(d,{ref_key:"formRef",ref:o,model:r.value},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{label:"名稱",path:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:r.value.name,"onUpdate:value":t[0]||(t[0]=e=>r.value.name=e),placeholder:"输入名稱"},null,8,["value"])]),_:1}),Object(l["createVNode"])(n,{label:"電話",path:"phone"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:r.value.phone,"onUpdate:value":t[1]||(t[1]=e=>r.value.phone=e),placeholder:"输入電話"},null,8,["value"])]),_:1}),Object(l["createVNode"])(n,{label:"Email",path:"email"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(a,{value:r.value.email,"onUpdate:value":t[2]||(t[2]=e=>r.value.email=e),placeholder:"輸入Email"},null,8,["value"])]),_:1}),Object(l["createVNode"])(n,{label:"學校",path:"manageSchool"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{value:r.value.manageSchool,"onUpdate:value":t[3]||(t[3]=e=>r.value.manageSchool=e),placeholder:"輸入學校",options:Object(l["unref"])(c),multiple:""},null,8,["value","options"])]),_:1})]),_:1},8,["model"])])}}};const w=g;var C=w;const k={class:"delete-title"};var V={__name:"Delete",props:{data:{type:Object,default(){return{id:null,name:null,phone:null,email:null}}}},setup(e,{expose:t}){const a=e,o=Object(l["computed"])(()=>{var e,t;return null!==(e=null===(t=a.data)||void 0===t?void 0:t.name)&&void 0!==e?e:""});return t({getData(){return a.data},upload(e,t){return Object(m["a"])({url:"/teacher/"+t,method:"delete",data:e},{fakeData:null,getFakeData:!0})}}),(e,t)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",k,Object(l["toDisplayString"])(`確定刪除 ${Object(l["unref"])(o)} 嗎?`),1))}},N=(a("c844"),a("6b0d")),x=a.n(N);const S=x()(V,[["__scopeId","data-v-9a19d8f8"]]);var D=S,_=a("ee50");const y=[{id:1,name:"測試人員",phone:"0912345678",email:"testUser123@gmail.com",manageSchool:[1,2],key:1},{id:2,name:"測試人員2",phone:"0987654321",email:"testUser2@gmail.com",manageSchool:[1,2,3],key:2},{id:3,name:"小丸子",phone:"0956432879",email:"vul36678@gmail.com",manageSchool:[2,4],key:3},{id:5,name:"測試老師",phone:"0978878454",email:"test456@gmail.com",manageSchool:[2,3,4],key:5}];var E=a("98922"),M=Object(l["defineComponent"])({components:{TeacherFilter:v,Create:f,Edit:C,Delete:D},setup(){const e=Object(l["ref"])(!1),t=Object(l["ref"])(0),a={school:Object(b["a"])(),teacher:Object(_["a"])()},o=e=>{var t;const l=a.school.list.find(t=>t.id===e);return null!==(t=null===l||void 0===l?void 0:l.name)&&void 0!==t?t:`無此學校 ${e} ID`},n=Object(l["ref"])(null),c=Object(l["reactive"])({name:null,phone:null,email:null,manageSchool:null}),r=Object(l["reactive"])({});function s(e){e.$forEach((e,t)=>{r[t]=e})}const p=()=>{c.name=null,c.phone=null,c.email=null,c.manageSchool=null;const e=n.value.getData();s(e),t.value++},h=()=>{n.value.setData();const e=n.value.getData();s(e),t.value++},v=Object(l["ref"])([]),O=Object(l["computed"])(()=>v.value.reduce((e,{columnKey:t,order:a})=>(e[t]=a,e),{}));function j(e){v.value=[].concat(e)}const f=Object(l["computed"])(()=>[{key:"name",title:"名稱",width:150},{title:"電話",key:"phone",width:150},{title:"E-mail",key:"email",minWidth:200,sortOrder:O.value.email||!1,sorter:(e,t)=>e.email.length-t.email.length},{title:"負責學校",key:"manageSchool",minWidth:200,sortOrder:O.value.manageSchool||!1,sorter:(e,t)=>e.manageSchool.length-t.manageSchool.length,render(e){const t=e.manageSchool.map(e=>Object(l["h"])(d["a"],{style:{margin:"2px 6px 2px 0"},type:"info",bordered:!1},{default:()=>o(e)}));return t}},{title:"管理",key:"actions",width:150,render(e){return Object(l["h"])("div",{class:"n-ga-md flex-row"},{default:()=>[Object(l["h"])(i["b"],{size:"small",onClick:()=>{U(e)}},{default:()=>"編輯"}),Object(l["h"])(i["b"],{size:"small",onClick:()=>{A(e)},type:"error"},{default:()=>"刪除"})]})}}]),g=Object(l["reactive"])([]),w=async()=>{await Object(m["a"])({url:"/teacher",method:"get"},{fakeData:y,getFakeData:!0}).then(e=>{e.forEach(e=>{g.push({key:e.id,...e})})})},C=async()=>{e.value=!0,g.splice(0),await Promise.all([w(),a.teacher.init()]),e.value=!1};Object(l["onMounted"])(()=>{C()});const k=Object(l["ref"])(null),V=Object(l["reactive"])({create:!1,edit:!1,delete:!1}),N=Object(E["a"])(),x=Object(l["ref"])(null),S=()=>{V.create=!0},D=()=>{const e=x.value.getData(),t=x.value.upload(e);t.then(()=>{const e="success";N[e]({content:"成功",meta:"資料更新",duration:1500,keepAliveOnHover:!0}),C(),V.create=!1})},M=Object(l["ref"])(null),U=e=>{V.edit=!0,k.value=e},F=()=>{V.edit=!1,k.value=null},B=()=>{const e=M.value.getData(),t=e.id,a=M.value.upload(e,t);a.then(()=>{const e="success";N[e]({content:"成功",meta:"資料更新",duration:1500,keepAliveOnHover:!0}),C(),V.edit=!1})},T=Object(l["ref"])(null),A=e=>{V.delete=!0,k.value=e},H=()=>{V.delete=!1,k.value=null},K=()=>{const e=T.value.getData(),t=e.id,a=T.value.upload(e,t);a.then(()=>{const e="success";N[e]({content:"成功",meta:"資料更新",duration:1500,keepAliveOnHover:!0}),C(),V.delete=!1})};return{loading:e,Add12Filled:u["a"],tableKey:t,store:a,getSchoolName:o,formValue:c,filterFrom:r,refFilter:n,clearFilter:p,submitFilter:h,columns:f,teacherData:g,handleUpdateSorter:j,currentModalData:k,showModal:V,refCreate:x,openCreate:S,addTeacher:D,refEdit:M,openEdit:U,cancelEdit:F,updateTeacher:B,refDelete:T,openDelete:A,cancelDelete:H,deleteTeacher:K}}});a("9ad5");const U=x()(M,[["render",r],["__scopeId","data-v-40561ed8"]]);t["default"]=U},"605d":function(e,t,a){var l=a("c6b6"),o=a("da84");e.exports="process"==l(o.process)},"65e2":function(e,t,a){"use strict";var l=a("7a23");const o={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 12 12"},n=Object(l["createElementVNode"])("g",{fill:"none"},[Object(l["createElementVNode"])("path",{d:"M6.5 1.75a.75.75 0 0 0-1.5 0V5H1.75a.75.75 0 0 0 0 1.5H5v3.25a.75.75 0 0 0 1.5 0V6.5h3.25a.75.75 0 0 0 0-1.5H6.5V1.75z",fill:"currentColor"})],-1),c=[n];t["a"]=Object(l["defineComponent"])({name:"Add12Filled",render:function(e,t){return Object(l["openBlock"])(),Object(l["createElementBlock"])("svg",o,c)}})},"86ba":function(e,t,a){},"9ad5":function(e,t,a){"use strict";a("86ba")},a640:function(e,t,a){"use strict";var l=a("d039");e.exports=function(e,t){var a=[][e];return!!a&&l((function(){a.call(null,t||function(){return 1},1)}))}},bdbf:function(e,t,a){},c844:function(e,t,a){"use strict";a("bdbf")},d58f:function(e,t,a){var l=a("59ed"),o=a("7b0b"),n=a("44ade"),c=a("07fa"),r=TypeError,u=function(e){return function(t,a,u,d){l(a);var i=o(t),m=n(i),b=c(i),s=e?b-1:0,p=e?-1:1;if(u<2)while(1){if(s in m){d=m[s],s+=p;break}if(s+=p,e?s<0:b<=s)throw r("Reduce of empty array with no initial value")}for(;e?s>=0:b>s;s+=p)s in m&&(d=a(d,m[s],s,i));return d}};e.exports={left:u(!1),right:u(!0)}}}]);
//# sourceMappingURL=chunk-a0535e8c.5915abc3.js.map